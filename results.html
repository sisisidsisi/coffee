<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì„¤ë¬¸ ê²°ê³¼ - ìµœê·¼ ì‘ë‹µ</title>
    <style>
        /* í˜ì´ì§€ ê¸°ë³¸ ìŠ¤íƒ€ì¼ (ì‚¬ì´íŠ¸ì— ë§ê²Œ ìˆ˜ì •í•˜ì„¸ìš”) */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
                Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
            background-color: #f9f9f9;
            color: #333;
            padding: 20px;
        }
        h1 {
            text-align: center;
            color: #2c3e50;
        }
        /* ì‘ë‹µ ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .response-container {
            max-width: 800px;
            margin: 20px auto;
        }
        .response-card {
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            padding: 20px;
            margin-bottom: 20px;
            border-left: 5px solid #1abc9c; /* í¬ì¸íŠ¸ ì»¬ëŸ¬ */
        }
        .response-card p {
            margin: 10px 0;
            line-height: 1.6;
        }
        .response-card strong {
            color: #34495e;
            min-width: 120px; /* ë¼ë²¨ ì •ë ¬ì„ ìœ„í•´ */
            display: inline-block;
        }
        /* ë¡œë”©/ì—ëŸ¬ ë©”ì‹œì§€ */
        #loading-message {
            text-align: center;
            font-size: 1.2em;
            color: #7f8c8d;
        }
    </style>
</head>
<body>

    <h1>ğŸ“Š ìµœê·¼ ì„¤ë¬¸ ì‘ë‹µ</h1>

    <div id="results-container" class="response-container">
        <p id="loading-message">ìµœê·¼ ì‘ë‹µì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
    </div>

    <p style="text-align: center; margin-top: 30px;">
        <a href="YOUR_ORIGINAL_EMBED_SHEET_URL">[ ğŸ“Š ì „ì²´ ê²°ê³¼ ì‹œíŠ¸ ë³´ê¸° ]</a>
    </p>

    <script>
        // 1. [ì¤‘ìš”] ì—¬ê¸°ì— 'ì›¹ì— ê²Œì‹œ'í•˜ì—¬ ìƒì„±ëœ CSV URLì„ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”.
        const GOOGLE_SHEET_CSV_URL = 'YOUR_PUBLISHED_GOOGLE_SHEET_CSV_URL';

        // 2. CSV ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ì„œ ì²˜ë¦¬í•˜ëŠ” í•¨ìˆ˜
        async function fetchSurveyResults() {
            const container = document.getElementById('results-container');
            const loadingMessage = document.getElementById('loading-message');

            try {
                const response = await fetch(GOOGLE_SHEET_CSV_URL);
                if (!response.ok) {
                    throw new Error('ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }
                const csvText = await response.text();
                
                // CSV í…ìŠ¤íŠ¸ë¥¼ ì¤„ ë‹¨ìœ„ë¡œ ë‚˜ëˆ„ê³ , í—¤ë”(ì²« ì¤„)ë¥¼ ì œì™¸í•©ë‹ˆë‹¤.
                const rows = csvText.trim().split('\n').slice(1);

                // ìµœê·¼ 5ê°œ ì‘ë‹µë§Œ ê°€ì ¸ì˜¤ê¸° ìœ„í•´ ë°°ì—´ì˜ ëì—ì„œ 5ê°œë¥¼ ìë¥´ê³ , ìˆœì„œë¥¼ ë’¤ì§‘ìŠµë‹ˆë‹¤.
                const recentRows = rows.slice(-5).reverse();

                if (recentRows.length === 0) {
                    loadingMessage.textContent = 'ì•„ì§ ë“±ë¡ëœ ì‘ë‹µì´ ì—†ìŠµë‹ˆë‹¤.';
                    return;
                }

                // ë¡œë”© ë©”ì‹œì§€ ì œê±°
                loadingMessage.style.display = 'none';

                // ê° ì‘ë‹µì„ HTML ì¹´ë“œë¡œ ë§Œë“¤ì–´ ì‚½ì…
                recentRows.forEach(rowString => {
                    // ì£¼ì˜: ì´ ê°„ë‹¨í•œ íŒŒì„œëŠ” ì‘ë‹µ ë‚´ìš©ì— ì½¤ë§ˆ(,)ê°€ í¬í•¨ë˜ë©´ ê¹¨ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                    // (ì˜ˆ: "ìŠ¤íƒ€ë²…ìŠ¤, ì´ë””ì•¼"ë¼ê³  ì‘ë‹µí•œ ê²½ìš°)
                    const columns = rowString.split(',');

                    // CSV ì—´ ìˆœì„œì— ë§ê²Œ ë°ì´í„°ë¥¼ ë§¤ì¹­ (íƒ€ì„ìŠ¤íƒ¬í”„, Q1, Q2, Q3, Q4, Q5)
                    const timestamp = columns[0] ? columns[0].replace(/"/g, '') : 'N/A';
                    const answer1 = columns[1] ? columns[1].replace(/"/g, '') : 'N/A';
                    const answer2 = columns[2] ? columns[2].replace(/"/g, '') : 'N/A';
                    const answer3 = columns[3] ? columns[3].replace(/"/g, '') : 'N/A';
                    const answer4 = columns[4] ? columns[4].replace(/"/g, '') : 'N/A';
                    const answer5 = columns[5] ? columns[5].replace(/"/g, '') : 'N/A';

                    const card = document.createElement('div');
                    card.className = 'response-card';
                    card.innerHTML = `
                        <p><strong>ì‘ë‹µ ì‹œê°„:</strong> ${timestamp}</p>
                        <hr style="border: 0; border-top: 1px solid #eee;">
                        <p><strong>1. í•˜ë£¨ ì»¤í”¼:</strong> ${answer1}</p>
                        <p><strong>2. ë¶ˆë©´/ê°ì„±:</strong> ${answer2}</p>
                        <p><strong>3. ë°©ë¬¸ ì¹´í˜:</strong> ${answer3}</p>
                        <p><strong>4. ì¶”ì¶œ ë°©ì‹:</strong> ${answer4}</p>
                        <p><strong>5. ì„ í˜¸ ì›ë‘:</strong> ${answer5}</p>
                    `;
                    container.appendChild(card);
                });

            } catch (error) {
                console.error('Error fetching results:', error);
                loadingMessage.textContent = 'ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
                loadingMessage.style.color = 'red';
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ í•¨ìˆ˜ ì‹¤í–‰
        fetchSurveyResults();
    </script>

</body>
</html>
